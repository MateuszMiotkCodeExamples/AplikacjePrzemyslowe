<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:text="${product.name + ' - Szczegóły'}">Szczegóły produktu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
  <!-- Komunikaty -->
  <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show">
    <span th:text="${successMessage}"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>

  <!-- Nawigacja -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a th:href="@{/products}">Lista produktów</a></li>
      <li class="breadcrumb-item active" th:text="${product.name}">Nazwa produktu</li>
    </ol>
  </nav>

  <!-- Szczegóły produktu -->
  <div class="card">
    <div class="row g-0">
      <!-- Zdjęcie produktu -->
      <div class="col-md-4" th:if="${product.imagePath}">
        <img th:src="@{/products/image/{fileName}(fileName=${product.imagePath})}"
             class="img-fluid rounded-start" alt="Zdjęcie produktu">
      </div>

      <!-- Informacje o produkcie -->
      <div th:class="${product.imagePath} ? 'col-md-8' : 'col-md-12'">
        <div class="card-body">
          <h2 class="card-title" th:text="${product.name}">Nazwa produktu</h2>
          <p class="card-text">
            <strong>Cena: </strong>
            <span th:text="${#numbers.formatDecimal(product.price, 1, 2)} + ' zł'"
                  class="text-primary fs-4"></span>
          </p>
          <p class="card-text" th:if="${product.category}">
            <strong>Kategoria: </strong>
            <span th:text="${product.category.name}"></span>
          </p>
          <p class="card-text" th:if="${product.description}"
             th:text="${product.description}"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Sekcja recenzji -->
  <div class="mt-4">
    <h3>Recenzje</h3>

    <!-- Formularz dodawania recenzji -->
    <form th:action="@{/products/{id}/review(id=${product.id})}" method="post"
          class="card card-body mb-3">
      <div class="mb-3">
        <label class="form-label">Dodaj recenzję</label>
        <textarea name="comment" class="form-control" rows="3" required></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Dodaj recenzję</button>
    </form>

    <!-- Lista recenzji -->
    <div th:if="${not #lists.isEmpty(product.reviews)}">
      <div th:each="review : ${product.reviews}" class="card mb-2">
        <div class="card-body">
          <p class="card-text" th:text="${review.comment}">Treść recenzji</p>
        </div>
      </div>
    </div>
    <div th:if="${#lists.isEmpty(product.reviews)}" class="alert alert-info">
      Ten produkt nie ma jeszcze recenzji.
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>